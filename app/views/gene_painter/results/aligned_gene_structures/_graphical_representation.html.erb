<div id='graphical' class="large_div">
  <div class="res_left_col" style='width: 125px'>
    <div id='genenames' class="res_height">
    </div>
  </div>

  <div id='right-column'>
    <div id='genestructures' class="res_height">
    </div>
  </div>

  <div id='legend' style='overflow: hidden'>
  </div>

  <div id='left-column' class="res_left_col" style='width: 125px'>
    <div id='genenames-merged' class="res_height" style='overflow: hidden'>
    </div>
  </div>

  <div id='right-column'>
    <div id='genestructures-merged' class="res_height" style="overflow-y: hidden">
    </div>
  </div>

  <%= javascript_tag defer: 'defer' do -%>

    // simultaneously scroll up/down, left/right
    $('div#genestructures').on('scroll', function() {
      $('div#genenames').scrollTop($(this).scrollTop());
      $('div#genestructures-merged').scrollLeft($(this).scrollLeft());
    });

    $('div#genestructures-merged').on('scroll', function() {
      $('div#genestructures').scrollLeft($(this).scrollLeft());
    });

    $('div#genenames').on('scroll', function() {
      $('div#genestructures').scrollTop($(this).scrollTop());
    });
   <% end -%>

</div>

<h4>View Options</h4>
<table>
  <tr>
    <td>
      <%=
        content_tag(:div,
          check_box_tag('standard') +
          content_tag(:span, 'Standard', :style => 'padding-left: 5px; padding-right: 20px')
          )
      %>

      <%=
        content_tag(:div,
          check_box_tag('focus_on_common_introns') +
          content_tag(:span, 'Focus on common introns', :style => 'padding-left: 5px; padding-right: 20px')
        )
      %>
    </td>
  <tr>
</table>

<%= javascript_tag defer: 'defer' do -%>
  $('input#standard').prop('checked', true);
<% end -%>

<script>

  $("div#graphical").find("div#genenames").append('<%= render_svg("#{controller.id}-genenames-normal.svg", "normal hide-horizontal-overflow").html_safe %>')
  $("div#graphical").find("div#genenames").append('<%= render_svg("#{controller.id}-genenames-reduced.svg", "reduced hide-horizontal-overflow").html_safe %>')

  $("div#graphical").find("div#genestructures").append('<%= render_svg("#{controller.id}-genestructures-normal.svg", "normal").html_safe %>')
  $("div#graphical").find("div#genestructures").append('<%= render_svg("#{controller.id}-genestructures-reduced.svg", "reduced").html_safe %>')

  $("div#graphical").find("div#legend").append('<%= render_svg("#{controller.id}-legend-normal.svg", "normal").html_safe %>')
  $("div#graphical").find("div#legend").append('<%= render_svg("#{controller.id}-legend-reduced.svg", "reduced").html_safe %>')

  function render_svg_normal_merged() {
    $("div#graphical").find("div#genenames-merged").html('<%= render_svg("#{controller.id}-genenames-normal-merged.svg", "normal-merged").html_safe %>')
    $("div#graphical").find("div#genestructures-merged").html('<%= render_svg("#{controller.id}-genestructures-normal-merged.svg", "normal-merged").html_safe %>')
  }

  render_svg_normal_merged();

  $("input#standard").prop("checked", true);
  $("div.reduced").toggle();

  $("input#standard").change(function() {
    if ($(this).is(":checked")) {
      $("input#focus_on_common_introns").prop("checked", false);
      $("div.reduced").toggle(false);
      $("div.normal").toggle(true);

      render_svg_normal_merged();
    }
  })

  $("input#focus_on_common_introns").change(function() {
    if ($(this).is(":checked")) {
      $("input#standard").prop("checked", false);
      $("div.normal").toggle(false);
      $("div.reduced").toggle(true);

      $("div#graphical").find("div#genenames-merged").html('<%= render_svg("#{controller.id}-genenames-reduced-merged.svg", "reduced-merged").html_safe %>')
      $("div#graphical").find("div#genestructures-merged").html('<%= render_svg("#{controller.id}-genestructures-reduced-merged.svg", "reduced-merged").html_safe %>')
    }
  })

  $('div#b_aligned_gene_structures').show('slow');
</script>
