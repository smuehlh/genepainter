<div id='graphical'>
  <img id='placeholder'>

  </img>

  <div id='svg-merged'>

  </div>
</div>

<h4>View Options</h4>
<table>
  <tr>
    <td>
      <%=
        content_tag(:div,
          check_box_tag('standard') +
          content_tag(:span, 'Standard', :style => 'padding-left: 5px; padding-right: 20px')
          )
      %>

      <%=
        content_tag(:div,
          check_box_tag('focus_on_common_introns') +
          content_tag(:span, 'Focus on common introns', :style => 'padding-left: 5px; padding-right: 20px')
        )
      %>
    </td>
    <td style='padding-left: 200px;'>
      <div id='select_genes' style = 'display: none'>
        <span>Select gene structures for viewing</span>
        <%= image_tag("icons/popup_icon.png", :style => "cursor: pointer", :id => 'gene_selection_popup') %>

        <div id='gene_selection_dialog' title="Select Gene Structures" style="display: none">
          <p>Select maximum of 20 genes.</p>
          <div id='placeholder' style='max-height: 300px; overflow: auto'></div>
        </div>
      </div>

      <%= javascript_tag defer: 'defer' do -%>
        $('img#gene_selection_popup').click(function() {

          $('div#gene_selection_dialog').dialog({
            modal: true,
            buttons: {
              Ok: function() {
                var selected_genes = _.filter($('div#placeholder').find('input#view'), function(item) {
                  return $(item).is(':checked');
                }).map(function(item){
                  return $(item).attr('data');
                });

                if (selected_genes.length) {
                  $.ajax({
                    type: 'POST',
                    url: '/build_svg',
                    data: {'data': selected_genes},
                    dataType: 'script'
                  });
                }

                $( this ).dialog( "close" );
              }
            }
          });
        });
      <% end -%>
    </td>
  <tr>
</table>

<%= javascript_tag defer: 'defer' do -%>
  $('input#standard').prop('checked', true);
<% end -%>
